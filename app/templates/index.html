<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اربعین یار</title>

    <!-- Favicon-->
    <link rel="icon" href="../static/css/images/favicon.png" type="image/x-icon">

    <!-- icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />

    <!-- Sign in dependencies -->
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&subset=latin,cyrillic-ext" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" type="text/css">

    <!-- Bootstrap Core Css -->
    <link href="../static/css/bootstrap.css" rel="stylesheet">

    <!-- Custom Css -->
    <link href="../static/css/style.css" rel="stylesheet">    
    
    <!-- My Css -->
    <link href="../static/css/app.css" rel="stylesheet"/>

    <!-- Sign up dependencies -->
    <!-- Waves Effect Css -->
    <link href="../static/css/waves.css" rel="stylesheet" />

    <!-- Animation Css -->
    <link href="../static/css/animate.css" rel="stylesheet" />

    <!-- Dashboard dependencies -->
    <!-- Bootstrap RTL Css -->
    <link href="../static/css/bootstrap-rtl.min.css" rel="stylesheet">

    <!-- Custorm RTL Css -->
    <link href="../static/css/style-rtl.css" rel="stylesheet">

    <!-- Themes -->
    <link href="../static/css/all-themes.css" rel="stylesheet" />
    
    <!-- Leaflet -->
    <link rel="stylesheet" href="../static/css/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <!-- Light Gallery Plugin Css -->
    <link href="../static/css/lightgallery.css" rel="stylesheet">




</head>
<body>
    <div id="app">    
        
        <!-- Signin manager panel -->
        <section v-if="panel == 'sign-in'" >

            <div class="login-page login-box">
                <div class="card">
                    <div class="body">
                        <form>
                            <div class="msg">برای شروع وارد حساب خود شوید</div>
                            <div class="input-group">
                                <span class="input-group-addon">
                                    <i class="material-icons">person</i>
                                </span>
                                <div class="form-line">
                                    <input v-model="username" type="text" class="form-control" name="username" placeholder="نام کاربری" required autofocus>
                                </div>
                            </div>
                            <div class="input-group">
                                <span class="input-group-addon">
                                    <i class="material-icons">lock</i>
                                </span>
                                <div class="form-line">
                                    <input v-model="password" type="password" class="form-control" name="password" placeholder="رمز عبور" required>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-8 p-t-5">
                                </div>
                                <div class="col-xs-4">
                                    <button @click.prevent="signinManager" class="btn btn-block bg-pink waves-effect" type="submit">ورود</button>
                                </div>
                            </div>                    
                            <div @click.prevent="change_panel('sign-up',null)" class="row m-t-15 m-b--20">
                                <div class="col-xs-6">
                                    <button><a >همین حالا ثبت نام کنید</a></button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>
        <!-- # Signin panel -->


        <!-- Signup manager panel -->
        <section v-if="panel == 'sign-up'">
            <div class="login-page login-box">
                <div class="card">
                    <div class="body">
                        <form>
                            <div class="msg">برای خود یک حساب بسازید</div>
                            <div class="input-group">
                                <span class="input-group-addon">
                                    <i class="material-icons">account_circle</i>
                                </span>
                                <div class="form-line">
                                    <input v-model="fullname" type="name" class="form-control" name="name" placeholder="نام و نام خانوادگی" required>
                                </div>
                            </div>        
                            <div class="input-group">
                                <span class="input-group-addon">
                                    <i class="material-icons">person</i>
                                </span>
                                <div class="form-line">
                                    <input v-model="username" type="text" class="form-control" name="username" placeholder="نام کاربری" required autofocus>
                                </div>
                            </div>
                            <div class="input-group">
                                <span class="input-group-addon">
                                    <i class="material-icons">lock</i>
                                </span>
                                <div class="form-line">
                                    <input v-model="password" type="password" class="form-control" name="password" placeholder="رمز عبور" required>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-8 p-t-5">
                                </div>
                                <div class="col-xs-4">
                                    <button @click.prevent="signupManager" class="btn btn-block bg-pink waves-effect" type="submit">ثبت نام</button>
                                </div>
                            </div>                    
                            <div @click.prevent="change_panel('sign-in',null)" class="row m-t-15 m-b--20">
                                <div class="col-xs-6">
                                    <button><a >از قبل عضو شده اید؟</a></button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

        </section>
        <!-- # Signup panel -->



        <!-- manager panel -->        
        <section v-if="panel == 'manager'" class="theme-teal" >
            
            <!-- Top Bar -->
            <nav class="navbar">
                <div v-if="selected_karavan_uuid != '' && manager_panel != 'user-all-locations' && show_all_users_locations_on_map == false" class="topnav1">
                    <div class="search-container1 ">
                      <form>
                        <input v-model="search_bar_val" type="text" placeholder="جستجو با نام یا نام کاربری..." style="font: 1.25rem/3">
                        <button @click.prevent="onClick_searchBarAdvs()" type="submit">
                            <span class="material-symbols-outlined">search</span>
                        </i></button>
                      </form>
                    </div>
                </div>                  
            </nav>
            <!-- #Top Bar -->

            <section>
                <!-- Right Sidebar -->
                <aside id="leftsidebar" class="sidebar">
                    <!-- Menu -->
                    <div class="menu">
                        <ul class="list">
                            <li class="header">ناوبری اصلی</li>
                            <li>
                                <a :class="{ activePanel: isActivePanel('manager-dashboard') }"  @click.prevent="getKaravanUsersInfo(1)" style="background-color:darkcyan;" href="#">
                                    <i style="color: darkgray" class="material-icons">home</i>
                                    <span style="color:aliceblue;">صفحه اصلی</span>
                                </a>
                            </li>
                            <div style="padding-top:3px"></div>
                            <li>
                                <a @click.prevent="addKaravan" style="background-color:darkcyan;" href="#">
                                    <i style="color: darkgray" class="material-icons">groups_3</i>
                                    <span style="color:aliceblue;">افزودن کاروان</span>
                                </a>
                            </li>
                            <div style="padding-top:3px"></div>
                            <li>
                                <a @click.prevent="addUserToKaravan" style="background-color:darkcyan;" href="#">
                                    <i style="color: darkgray" class="material-icons">person_add</i>
                                    <span style="color:aliceblue;">افزودن عضو به کاروان</span>
                                </a>
                            </li>
                            <div style="padding-top:3px"></div>
                            <li>
                                <a :class="{ activePanel: isActivePanel('souvenir-photos') }" @click.prevent="getSouvenirPhotos(1)" style="background-color:darkcyan;" href="javascript:void(0);" class="toggled">
                                    <i style="color: darkgray" class="material-icons">photo_library</i>
                                    <span style="color:aliceblue;">عکس های یادگاری</span>
                                </a>
                            </li>
                            <div style="padding-top:3px"></div>
                            <li>
                                <a :class="{ activePanel: isActivePanel('registered-locations') }" @click.prevent="getRegisteredLocations(1)" style="background-color:darkcyan;" href="javascript:void(0);" class="toggled">
                                    <i style="color: darkgray" class="material-icons">person_pin_circle</i>
                                    <span style="color:aliceblue;">موقعیت های مکانی</span>
                                </a>
                            </li>
                            <div style="padding-top:8px"></div>
                            <div v-if="show_location == 'true'" id="map"></div>
                        </ul>
                    </div>
                    <!-- #Menu -->
                    
                </aside>
                
                <!-- #END# Right Sidebar -->
            </section>
            
            <!-- Manager dashboard show all users -->
            <section v-if="manager_panel == 'manager-dashboard'" class="content">
                <div class="container-fluid">
                    <div class="row clearfix">
                        <!-- Task Info -->
                        <div class="col-xs-12 col-sm-12">
                            <div class="header">
                                <label for="category">کاروان مورد نظر را انتخاب کنید</label>
                                <div class="select">
                                    <select v-model="selected_karavan_uuid" @change="changeSelectedKaravan">
                                        <option value="">انتخاب کاروان</option>
                                        <option v-for="karavan in manager_karavans_info" :value=karavan[0] >${karavan[1]}$</option>
                                    </select>
                                </div>
                            </div>
                            
                            <br/>
                            <div v-if="show_panel == 'true'" class="card">
                                
                                <div class="body panels">
                                    <h3>اطلاعات اعضای کاروان</h3>
                                    <div class="table-responsive">
                                        
                                        <table class="table table-hover dashboard-task-infos">
                                            <thead>
                                                <tr>
                                                    <th>نام</th>
                                                    <th>نام کاربری</th>
                                                    <th>رمز عبور</th>
                                                    <th>موقعیت های مکانی</th>
                                                    <th>وضعیت حساب</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr v-for="user in users_info">
                                                    <td>${ user[2] }$</td>
                                                    <td>${ user[3] }$</td>
                                                    <td>${ user[4] }$</td>
                                                    <td > <a @click.prevent="showUserAllLocations(user[0],false)" target="_blank" href="#" >مشاهده</a> </td>
                                                    <td>${ user[5] }$</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="pagination">
                                        <a v-for="(page_num,index) in pages"
                                            :key="index"
                                            @click.prevent="getKaravanUsersInfo(index + 1)"
                                            :class="{ active: isActivePage(index + 1) }" 
                                            href="#">${ page_num }$</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- # admin show all users -->


            <!-- Manager show souvenir photos -->
            <section v-if="manager_panel == 'souvenir-photos'" class="content">
                <div class="container-fluid">
                    <div class="row clearfix">
                        <!-- Task Info -->
                        <div class="">

                            <div class="header col-md-7">
                                <label for="category">کاروان مورد نظر را انتخاب کنید</label>
                                <div class="select">
                                    <select v-model="selected_karavan_uuid" @change="changeSelectedKaravan">
                                        <option value="">انتخاب کاروان</option>
                                        <option v-for="karavan in manager_karavans_info" :value=karavan[0] >${karavan[1]}$</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-2">
                                <label for="category">فیلتر زمان</label>
                                <div class="select" style="width:150px">
                                    <select v-model="selected_time" @change="getSouvenirPhotos(1)">
                                        <option value="all">همه</option>
                                        <option value="today">امروز</option>
                                        <option value="week">این هفته</option>
                                        <option value="month">این ماه</option>
                                        <option value="year">امسال</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-3">
                                <label for="category">فیلتر رویداد</label>
                                <div class="select" style="width:150px">
                                    <select v-model="selected_event" @change="getSouvenirPhotos(1)">
                                        <option value="all">همه</option>
                                        <option value="arbaeen">اربعین</option>
                                        <option value="moharram">محرم</option>
                                        <option value="fetr">فطر</option>
                                        <option value="ghadir">غدیر</option>
                                        <option value="other">سایر رویدادها</option>
                                    </select>
                                </div>
                            </div>


                            <div style="height:80px;"></div>
                            <div v-if="show_panel == 'true'" class="card">

                                <div class="body panels">
                                    <div class="col-xs-12 col-sm-12">
                                        <div class="col-md-10">
                                            <h3>عکس های یادگاری</h3>
                                        </div>

                                        <div class="col-md-2">
                                            <!-- Switch Button -->
                                            <div class="switch" style="padding-top:20px;">
                                                <label @change="changePanelForAllUsersSouvenirPhotos">
                                                    <i class="material-icons">view_list</i>
                                                    <input type="checkbox" checked>
                                                    <span style="margin-top:-15px" class="lever"></span>
                                                    <i class="material-icons">photo_library</i>
                                                </label>
                                            </div>
                                            <!--#END# Switch Button -->
                                        </div>
                                    </div>
                                    <div v-if="show_all_users_souvenir_album == false" class="table-responsive">
                                        <table class="table table-hover dashboard-task-infos">
                                            <thead>
                                                <tr>
                                                    <th>نام</th>
                                                    <th>نام کاربری</th>
                                                    <th>تاریخ</th>
                                                    <th>زمان</th>
                                                    <th>رویداد</th>
                                                    <th>نام سرویس</th>
                                                    <th>عکس دریافتی</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr v-for="photo in souvenir_photos">
                                                    <td>${ photo[0] }$</td>
                                                    <td>${ photo[1] }$</td>
                                                    <td>${ photo[3]['date'] }$</td>
                                                    <td>${ photo[3]['time'] }$</td>
                                                    <td>${ photo[4]['event'] }$</td>
                                                    <td>${ photo[5] }$</td>
                                                    <td> <a :href="photo[4]['path']" target="_blank">نمایش</a> </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>


                                    <section v-if="show_all_users_souvenir_album == true">
    
                                        <div class="list-unstyled row" style="margin-top:120px;">
                                            <div v-for="photo in souvenir_photos" class="col-lg-3 col-md-4 col-sm-6 col-xs-12" style="margin-top:-45px">
                                                <a class="container-album" :href="photo[4]['path']" target="_blank" >

                                                    <img class="img-responsive thumbnail album-img-fix-size image-album" 
                                                        style="width:100%" :src="photo[4]['path']">
                                                    <div class="middle-album">
                                                        <div class="text-album">نام: ${ photo[0] }$ </div>
                                                        <div class="text-album">نام کاربری: ${ photo[1] }$</div>
                                                        <div class="text-album">تاریخ : ${ photo[3]['date'] }$</div>
                                                        <div class="text-album">زمان : ${ photo[3]['time'] }$</div>
                                                    </div>
                                                        
                                                </a>
                                            </div>
                                        </div>
                                    </section>


                                    <div class="pagination">
                                        <a v-for="(page_num,index) in pages"
                                            :key="index"
                                            @click.prevent="getSouvenirPhotos(index + 1)"
                                            :class="{ active: isActivePage(index + 1) }" 
                                            href="#">${ page_num }$
                                        </a>
                                    </div>
                                </div>


                            


                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- # Manager show souvenir photos -->


            <!-- Manager show all users locations -->
            <section v-if="manager_panel == 'registered-locations'" class="content">
                <div class="container-fluid">
                    <div class="row clearfix">
                        <!-- Task Info -->
                        <div class="col-xs-12 col-sm-12">

                            <div class="header col-md-7">
                                <label for="category">کاروان مورد نظر را انتخاب کنید</label>
                                <div class="select">
                                    <select v-model="selected_karavan_uuid" @change="changeSelectedKaravan">
                                        <option value="">انتخاب کاروان</option>
                                        <option v-for="karavan in manager_karavans_info" :value=karavan[0] >${karavan[1]}$</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-5">
                                <label for="category">فیلتر زمان</label>
                                <div class="select" style="width:150px">
                                    <select v-model="selected_time" @change="getRegisteredLocations(1)">
                                        <option value="all">همه</option>
                                        <option value="today">امروز</option>
                                        <option value="week">این هفته</option>
                                        <option value="month">این ماه</option>
                                        <option value="year">امسال</option>
                                    </select>
                                </div>
                            </div>

                            <div style="height:80px;"></div>
                            <div v-if="show_panel == 'true'" class="card">

                                <div class="body panels">
                                    <div class="col-xs-12 col-sm-12">
                                        <div class="col-md-10">
                                            <h3>موقعیت های مکانی ثبت شده<h3>
                                        </div>

                                        <div class="col-md-2">
                                            <!-- Switch Button -->
                                            <div class="switch" style="padding-top:20px;">
                                                <label @change="changePanelForAllUsersLocations">
                                                    <i class="material-icons">view_list</i>
                                                    <input type="checkbox" checked>
                                                    <span style="margin-top:-15px" class="lever"></span>
                                                    <i class="material-icons">location_on</i>
                                                </label>
                                            </div>
                                            <!--#END# Switch Button -->
                                        </div>
                                    </div>

                                    <div v-if="show_all_users_locations_on_map == false" class="table-responsive">
                                        <table class="table table-hover dashboard-task-infos">
                                            <thead>
                                                <tr>
                                                    <th>نام</th>
                                                    <th>نام کاربری</th>
                                                    <th>تاریخ</th>
                                                    <th>زمان</th>
                                                    <th>طول جغرافیایی</th>
                                                    <th>عرض جغرافیایی</th>
                                                    <th>نام سرویس</th>
                                                    <th>نمایش روی نقشه</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr v-for="location in registered_locations">
                                                    <td>${ location[0] }$</td>
                                                    <td>${ location[1] }$</td>
                                                    <td>${ location[3]['date'] }$</td>
                                                    <td>${ location[3]['time'] }$</td>
                                                    <td>${ location[4]['longitude'] }$</td>
                                                    <td>${ location[4]['latitude'] }$</td>
                                                    <td>${ location[5] }$</td>
                                                    <td> <a @click.prevent="showLocation(location[4]['longitude'], location[4]['latitude'])" href="#">
                                                        <span v-if="show_location == 'true'" >بستن</span>
                                                        <span v-else >نمایش</span>
                                                        </a>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>

                                    </div>
                                    <div v-if="show_all_users_locations_on_map == false" class="pagination">
                                        <a v-for="(page_num,index) in pages"
                                            :key="index"
                                            @click.prevent="getRegisteredLocations(index + 1)"
                                            :class="{ active: isActivePage(index + 1) }"
                                            href="#">${ page_num }$</a>
                                    </div>

                                    <!-- Show all users location on map -->
                                    <div v-if="show_all_users_locations_on_map == true" id="all_users_locs_on_map" class="map" ></div>
  
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </section>
            <!-- # Manager show all users locations -->



            <!-- Manager show user all locations -->
            <section v-if="manager_panel == 'user-all-locations'" class="content">

                <h4 style="text-align:center;">موقعیت های مکانی ثبت شده ${ userAllLocations[0][4] }$</h4>
                <div class="container-fluid">
                    <div class="row clearfix" style="margin-right:60px;">

                        <div id="user_all_locs_map" class="map"></div>

                        <div class="col-xs-12 col-sm-12">
                            <div class="col-md-7" style="margin-top:40px;">
                                <a @click.prevent="change_panel('manager','manager-dashboard')" class="btn-cancel">بازگشت به صفحه اصلی</a>
                            </div>

                            <div class="col-md-4" style="margin-top:10px;">
                                <label for="category">فیلتر زمان</label>
                                <div class="select" style="width:200px">
                                    <select v-model="user_locations_selected_time" @change="showUserAllLocations(userAllLocations[0][6],true)">
                                        <option value="all">همه</option>
                                        <option value="today">امروز</option>
                                        <option value="week">این هفته</option>
                                        <option value="month">این ماه</option>
                                        <option value="year">امسال</option>
                                    </select>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>
            </section>
            <!-- # Manager show user all locations -->



        </section>

    </div>
    
    <!-- leaflet -->
    <script src="../static/scripts/leaflet.js"  integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
        <!-- Waves Effect Plugin Js -->
    <script src="../static/scripts/waves.js"></script>

    <!-- Alerts -->
    <script type="text/javascript" src="../static/scripts/sweetalert2.all.min.js"></script>

    <!-- Custom -->
    <script type="text/javascript" src="../static/scripts/vue.global.js"></script>
    <script type="text/javascript" src="../static/scripts/axios.min.js"></script>
    <script type="text/javascript" src="../static/scripts/app.js"></script>
    <!-- Dashboard panel -->

    <!-- Jquery Core Js -->
    <script src="../static/scripts/jquery.min.js"></script>    

    <!-- Custom Js -->
    <script src="../static/scripts/admin.js"></script>
    <script src="../static/scripts/image-gallery.js"></script>

    <!-- Light Gallery Plugin Js -->
    <script src="../static/scripts/lightgallery-all.js"></script>



</body>
</html>